os: linux
language: python
python: 3.7
install:
    - pip install -r requirements.txt
    - pip install -r ci/requirements.txt
    - pip install -r tests/unit/requirements.txt
script:
    - pip install -e .
    - ci/static_checks.sh altimeter
    - ci/test.sh altimeter tests/unit
    - export PYTHONPATH=.
    - sphinx-apidoc -f -o doc/source altimeter
    - sphinx-build doc/source doc/html -E -W
deploy:
    - provider: pypi
        user: "__token__"
        password:
            secure: "oXWWn+yLy0sZhZrE/Pv3pd4GaoufgLbKZ3HoAWMdudZwK6YI/xikw3wn1yfnuyhcUFGemoE99oE7Xz3+jUmINVElzqnlkpG6/j6FYuPZU4Ca90hyLX9E0Ojw5RYx3PqCOGAtt6qyjRrS7doVyUwAd5hcryKupQrz8fWpfECP11kVxxhk4Bxq08UfZrLGzxsMd0rGL8FiHlV7d4EDW6X8v0t+I6YulqrkW2nyeXQrRie5+01DMxBBwXAF477UvHuDwfjZ/2JH2pk7p3cF0VI0FLfdPe3+k/tuodbGYJr9t3qtl1pqzc4PzC4qfnZIOelnEcWBFIGMzVWjKNdChBu5iqgQGSiY0/R43qNQk66Ioj9++wQKWWlKS+eaqI4A1k182ioSscC17GwyY6OJ0VzU5gengfkk36oBBr0w8JjIsu8piq9/Ea+QRZJMnjYy/tExyAGheVB0QjIhIaJBCb/04igq8s9VOdgWtLBbWdhe/B6XI/3Hl0F1ztJz5078fYYVQr/RuXsQOdiYy4TpIoPSdla3BgW7kwPKetfYd1VGE1tdbLiBtCsJZVjcRLn9yOowze85OmD2eYunKQuCW6SCgSUspoSCuVWoNUrYLlJgXpjuXkPGOXK7Vd2hiw2vRKfSp8YVANpPzUpP8C1Sn29XMnOw5u6hKnOlpCgsen0bemM="
        skip_existing: true
        on:
            tags: true
            branch: master
#    - provider: pages
#        github_token:
#            secure: "SvhOQrXR+pf26gWrrzpqh9nymjFUzIblWoY4zVRLuEdFoxPO9BhlH+1LUXK32roCgtOeclkCs+qw8qoB9mdLktqfvfQbd6uP+cYqe5LnSK7SWjLcOUP9n0hvMto27OFEM4tG+25oSeIiQ4bYGKu8J10OlUCb7eHdNRhCSn5Gqs21R87tBzN9ylnPLP/DYuv9m3+z30/BWnyZmhV+tIAAxrn5nmxts1S2lNJCQ8d1CfRhwrLOCN8Kd06tVnRcrRHi5Azp0C23CB0H3vfPAmmBXZbB2HAPB01iZeHd2WleiiC/HP6gonSf8ldgHxZusas3EAhhA0TSVdanquxfo4jZmHGlBH6z9Nea19oTGmAS3JpT1PWTh450U4N653gN7mGsy7q1HPsJNp0ndEX5k/sU00NT7n5HmmDshuZ7/UIMot5UnSpkVdQNRXHZ5NkeE4tJZJZ4Qo71Xx5nmqZSNAcjOZdvolT6nhj7e07BYXzP/y9BJQzGiQmVjVJHnfHAuiu5q9YeYjO3XV0agtS7c5LUSyZNplCe73TW2WrlNpp72uHjdyqz7Fui46BgYHdR005MVOjZxaIf1L8jPJTTY4rfFb7D6DtozSN+0ugvw6SvPYPuO39AXHCsD5THurnHeKHaWvAyQXQE82lHkFqpY5esnwDMfPh7rf2UMnxisqTwjUg="
#        local_dir: doc/html
